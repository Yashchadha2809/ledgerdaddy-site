<!doctype html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NovaHub ‚Äî Chat ‚Ä¢ Calculator ‚Ä¢ Marketplace</title>
  <meta name="description" content="A friendly, modern, responsive website with a chatbot, smart calculator, and a simple marketplace." />
  <meta name="theme-color" content="#0f172a" id="meta-theme-color" />
  <link rel="canonical" href="https://example.com/" />
  <style>
    /* -------------------- Base & Theme -------------------- */
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;line-height:1.55}
    img{max-width:100%;display:block}
    a{text-decoration:none}
    :root{
      --bg:#0b1220; --panel:#0f172a; --soft:#131b2f; --text:#e5e7eb; --muted:#94a3b8; --border:#1f2941;
      --brand:#7c3aed; --brand-2:#22c55e; --accent:#06b6d4; --focus:#f59e0b;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
    }
    [data-theme="light"]{
      --bg:#f8fafc; --panel:#ffffff; --soft:#f1f5f9; --text:#0f172a; --muted:#475569; --border:#e2e8f0;
      --shadow: 0 12px 24px rgba(2,6,23,.08);
    }
    :focus-visible{outline:2px solid var(--focus);outline-offset:3px}
    .page{background:
      radial-gradient(1200px 600px at 15% -10%, rgba(124,58,237,.20), transparent 55%),
      radial-gradient(1200px 600px at 85% -10%, rgba(34,197,94,.18), transparent 55%),
      var(--bg);color:var(--text)}
    .container{width:min(1160px,92%);margin-inline:auto}
    .section{padding:3.5rem 0}
    .card{background:linear-gradient(0deg, rgba(255,255,255,.02), transparent), var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:1.25rem}
    .btn{display:inline-flex;align-items:center;gap:.6rem;padding:.7rem 1rem;border-radius:12px;border:1px solid var(--border);cursor:pointer;transition:transform .05s ease, box-shadow .2s ease}
    .btn:active{transform:translateY(1px)}
    .btn--primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;border-color:transparent}
    .btn--ghost{background:var(--panel);color:var(--text)}
    .badge{display:inline-flex;align-items:center;gap:.35rem;padding:.2rem .6rem;border:1px solid var(--border);border-radius:999px;color:var(--muted);font-size:.85rem}

    /* -------------------- Header -------------------- */
    .header{position:sticky;top:0;z-index:50;backdrop-filter:blur(12px);background:rgba(0,0,0,.22);border-bottom:1px solid var(--border)}
    [data-theme="light"] .header{background:rgba(255,255,255,.7)}
    .header__inner{display:flex;align-items:center;justify-content:space-between;padding:.75rem 0}
    .brand{display:flex;align-items:center;gap:.65rem;color:inherit}
    .brand__logo{width:36px;height:36px;border-radius:10px;background:conic-gradient(from 180deg,var(--brand),var(--accent),var(--brand-2),var(--brand));display:grid;place-items:center;color:#fff;font-weight:800;box-shadow:var(--shadow)}
    .nav{display:flex;gap:1rem;align-items:center}
    .nav__menu{display:flex;gap:1rem;list-style:none;margin:0;padding:0}
    .nav__link{color:var(--muted)}
    .nav__link:hover{color:var(--text)}
    .nav__toggle{display:none}
    .cart{display:flex;gap:.5rem;align-items:center}
    .cart__count{display:grid;place-items:center;min-width:22px;height:22px;border-radius:999px;background:var(--brand);color:#fff;font-size:.8rem}

    /* -------------------- Hero -------------------- */
    .hero{padding:3.2rem 0}
    .hero__wrap{display:grid;gap:1.2rem;grid-template-columns: 1.2fr .8fr;align-items:center}
    @media (max-width: 960px){.hero__wrap{grid-template-columns:1fr}}
    .hero__title{font-size:clamp(1.8rem,3.6vw,2.6rem);margin:0}
    .hero__tag{color:var(--muted);margin:0}
    .hero__img{border-radius:18px;overflow:hidden;border:1px solid var(--border)}
    .hero__img > img{width:100%;height:100%;object-fit:cover}

    /* -------------------- Grid -------------------- */
    .grid{display:grid;gap:1.1rem}
    @media (min-width: 960px){ .grid--2 {grid-template-columns: 1fr 1fr;} .grid--3{grid-template-columns: repeat(3,1fr);} }

    /* -------------------- Calculator -------------------- */
    .form__row{display:grid;gap:.35rem;margin-bottom:.6rem}
    .form__label{font-weight:600}
    .form__input,.form__select{background:var(--soft);color:var(--text);border:1px solid var(--border);border-radius:10px;padding:.6rem .7rem}
    .kpi{display:flex;flex-wrap:wrap;gap:.6rem;margin-top:.5rem}
    .kpi__pill{background:var(--soft);border:1px solid var(--border);border-radius:999px;padding:.4rem .7rem}
    .switch{display:inline-flex;align-items:center;gap:.5rem;font-size:.92rem;color:var(--muted)}

    /* -------------------- Marketplace -------------------- */
    .market__controls{display:flex;flex-wrap:wrap;gap:.5rem;margin:.75rem 0}
    .market__grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .product{display:grid;gap:.6rem;border:1px solid var(--border);border-radius:14px;background:var(--panel);padding:.8rem;transition:transform .12s ease, box-shadow .2s ease}
    .product:hover{transform:translateY(-2px);box-shadow:var(--shadow)}
    .product__img{height:140px;border-radius:10px;overflow:hidden;border:1px solid var(--border);background:var(--soft)}
    .product__meta{display:flex;align-items:center;justify-content:space-between}
    .stars{color:#fbbf24} /* amber */
    .product__price{color:var(--brand-2);font-weight:800}

    /* -------------------- Chatbot -------------------- */
    .chat{position:fixed;right:1rem;bottom:1rem;z-index:60}
    .chat__toggle{width:60px;height:60px;border-radius:999px;border:none;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;box-shadow:var(--shadow);cursor:pointer}
    .chat__panel{position:fixed;right:1rem;bottom:4.8rem;width:min(380px,92vw);background:var(--panel);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);overflow:hidden}
    .chat__header{display:flex;justify-content:space-between;align-items:center;padding:.65rem .8rem;background:var(--soft);border-bottom:1px solid var(--border)}
    .chat__log{max-height:340px;overflow:auto;padding:.8rem;display:grid;gap:.5rem}
    .bubble{padding:.55rem .75rem;border-radius:12px;max-width:85%}
    .bubble--me{justify-self:end;background:linear-gradient(135deg,var(--brand),var(--accent));color:#fff}
    .bubble--ai{background:var(--soft);border:1px solid var(--border)}
    .chips{display:flex;gap:.4rem;flex-wrap:wrap;margin:.2rem .2rem .6rem}
    .chip{background:var(--soft);border:1px solid var(--border);border-radius:999px;padding:.25rem .55rem;cursor:pointer}
    .chat__form{display:flex;gap:.45rem;padding:.6rem;border-top:1px solid var(--border)}
    .chat__input{flex:1;background:var(--soft);border:1px solid var(--border);border-radius:10px;padding:.55rem .7rem;color:var(--text)}
    .chat__send{border:1px solid var(--border);background:var(--panel);color:var(--text);border-radius:10px;padding:.55rem .85rem;cursor:pointer}

    /* -------------------- Footer -------------------- */
    .footer{border-top:1px solid var(--border);padding:2rem 0;color:var(--muted)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body class="page">
  <a class="sr-only" href="#main">Skip to content</a>

  <!-- Header -->
  <header class="header">
    <div class="container header__inner">
      <a class="brand" href="#" aria-label="Home"><span class="brand__logo">‚óÜ</span><strong>NovaHub</strong></a>
      <nav class="nav" aria-label="Primary">
        <ul class="nav__menu">
          <li><a class="nav__link" href="#marketplace">Marketplace</a></li>
          <li><a class="nav__link" href="#calculator">Calculator</a></li>
          <li><a class="nav__link" href="#why">Why NovaHub</a></li>
        </ul>
      </nav>
      <div class="cart" aria-label="Cart"><span>üõí</span><span id="cartCount" class="cart__count" aria-live="polite">0</span></div>
      <button id="themeToggle" class="btn btn--ghost" aria-pressed="false" aria-label="Toggle dark/light">üåó</button>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container hero__wrap">
      <div class="hero__copy">
        <h1 class="hero__title">Everything you need ‚Äî in one friendly page.</h1>
        <p class="hero__tag">Chat with the assistant, run quick calculations, and shop from a clean, image-rich marketplace. Fast, responsive, and accessible.</p>
        <div style="display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.8rem">
          <a class="btn btn--primary" href="#marketplace">Explore Marketplace</a>
          <a class="btn btn--ghost" href="#calculator">Open Calculator</a>
        </div>
        <div style="display:flex;gap:.5rem;margin-top:1rem;flex-wrap:wrap">
          <span class="badge">No signup needed</span>
          <span class="badge">Works great on mobile</span>
          <span class="badge">Dark / Light</span>
        </div>
      </div>
      <figure class="hero__img">
        <!-- Free Unsplash images (can swap later) -->
        <img src="https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?q=80&w=1200&auto=format&fit=crop" width="1200" height="800" alt="Friendly modern interface preview with cards and graphs" loading="eager"/>
      </figure>
    </div>
  </section>

  <main id="main">
    <div class="container grid grid--2 section">
      <!-- Calculator Card -->
      <section id="calculator" class="card" aria-labelledby="calcTitle">
        <h2 id="calcTitle" class="card__title">Smart Calculator</h2>
        <p style="margin-top:-.4rem;color:var(--muted)">Switch between <strong>Basic</strong>, <strong>GST</strong>, and <strong>Discount</strong>. Instant results.</p>

        <div class="switch" style="margin:.3rem 0 .8rem">
          <label><input type="radio" name="mode" value="basic" checked> Basic</label>
          <label><input type="radio" name="mode" value="gst"> GST</label>
          <label><input type="radio" name="mode" value="discount"> Discount</label>
        </div>

        <div id="calcFields">
          <!-- Fields injected by JS based on mode -->
        </div>

        <div class="kpi">
          <div class="kpi__pill"><strong>Result:</strong> <span id="calcResult">0</span></div>
          <div class="kpi__pill" id="calcExtra" hidden></div>
        </div>
      </section>

      <!-- Why card -->
      <section id="why" class="card" aria-labelledby="whyTitle">
        <h2 id="whyTitle" class="card__title">Why people like NovaHub</h2>
        <ul style="margin:0;padding-left:1.1rem">
          <li>Simple, **human** design with clear hierarchy and comfy spacing.</li>
          <li>Image-rich marketplace with fast search, filters, and cart that persists.</li>
          <li>Helpful chatbot with ready suggestions and inline calculation support.</li>
          <li>Accessible (labels, focus rings, contrast) and responsive across devices.</li>
        </ul>
        <div style="margin-top:1rem" class="grid grid--3">
          <img class="card" alt="UI sample 1" src="https://images.unsplash.com/photo-1556157382-97eda2d62296?q=80&w=900&auto=format&fit=crop" />
          <img class="card" alt="UI sample 2" src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=900&auto=format&fit=crop" />
          <img class="card" alt="UI sample 3" src="https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=900&auto=format&fit=crop" />
        </div>
      </section>
    </div>

    <!-- Marketplace -->
    <section id="marketplace" class="section">
      <div class="container card">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:.75rem;flex-wrap:wrap">
          <h2 class="card__title">Marketplace</h2>
          <span id="marketMeta" class="badge" aria-live="polite">0 items</span>
        </div>

        <div class="market__controls">
          <label class="sr-only" for="search">Search</label>
          <input id="search" class="form__input" type="search" placeholder="Search products‚Ä¶" />
          <label class="sr-only" for="category">Category</label>
          <select id="category" class="form__select">
            <option value="all">All categories</option>
            <option value="software">Software</option>
            <option value="hardware">Hardware</option>
            <option value="courses">Courses</option>
          </select>
          <label class="sr-only" for="sort">Sort</label>
          <select id="sort" class="form__select">
            <option value="featured">Featured</option>
            <option value="price-asc">Price: Low ‚Üí High</option>
            <option value="price-desc">Price: High ‚Üí Low</option>
          </select>
        </div>

        <div id="marketGrid" class="market__grid" role="list"></div>
      </div>
    </section>

    <!-- Testimonials -->
    <section class="section">
      <div class="container grid grid--3">
        <figure class="card">
          <blockquote>‚ÄúThe UI is clean and friendly. My mom figured it out in 2 minutes.‚Äù</blockquote>
          <figcaption style="margin-top:.6rem;color:var(--muted)">‚Äî Arjun P.</figcaption>
        </figure>
        <figure class="card">
          <blockquote>‚ÄúLove the dark mode and quick chatbot answers. Super handy!‚Äù</blockquote>
          <figcaption style="margin-top:.6rem;color:var(--muted)">‚Äî Sania K.</figcaption>
        </figure>
        <figure class="card">
          <blockquote>‚ÄúCart saved between visits. Calculator is actually useful daily.‚Äù</blockquote>
          <figcaption style="margin-top:.6rem;color:var(--muted)">‚Äî Dev M.</figcaption>
        </figure>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap">
      <small>¬© <span id="year"></span> NovaHub</small>
      <div style="display:flex;gap:.8rem">
        <a class="nav__link" href="#">Privacy</a>
        <a class="nav__link" href="#">Terms</a>
      </div>
    </div>
  </footer>

  <!-- Floating Chatbot -->
  <aside class="chat" aria-live="polite">
    <button id="chatToggle" class="chat__toggle" aria-expanded="false" aria-controls="chatPanel" title="Open chat">üí¨</button>
    <div id="chatPanel" class="chat__panel" hidden>
      <div class="chat__header">
        <strong>Assistant</strong>
        <button id="chatClose" class="btn btn--ghost" aria-label="Close chat">‚úï</button>
      </div>
      <div class="chips" id="chips">
        <button class="chip">Help</button>
        <button class="chip">Time</button>
        <button class="chip">Cart total</button>
        <button class="chip">Show deals</button>
        <button class="chip">calc 12+7</button>
      </div>
      <div id="chatLog" class="chat__log" role="log" aria-live="polite"></div>
      <form id="chatForm" class="chat__form" autocomplete="off">
        <label for="chatInput" class="sr-only">Type your message</label>
        <input id="chatInput" class="chat__input" placeholder="Ask anything‚Ä¶ e.g. 'find keyboard' or 'calc 5*9'"/>
        <button class="chat__send" type="submit">Send</button>
      </form>
    </div>
  </aside>

  <!-- App Script -->
  <script>
    /* -------------------- Theme -------------------- */
    const root = document.documentElement;
    const metaTheme = document.getElementById('meta-theme-color');
    const themeToggle = document.getElementById('themeToggle');
    const savedTheme = localStorage.getItem('theme');
    function setTheme(mode){
      root.setAttribute('data-theme', mode);
      localStorage.setItem('theme', mode);
      if(metaTheme) metaTheme.setAttribute('content', mode==='light' ? '#ffffff' : '#0f172a');
      themeToggle?.setAttribute('aria-pressed', String(mode==='dark'));
    }
    setTheme(savedTheme || (matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark'));
    themeToggle?.addEventListener('click', ()=> setTheme(root.getAttribute('data-theme')==='light' ? 'dark' : 'light'));
    document.getElementById('year').textContent = new Date().getFullYear();

    /* -------------------- Calculator -------------------- */
    const calcFields = document.getElementById('calcFields');
    const calcResult = document.getElementById('calcResult');
    const calcExtra = document.getElementById('calcExtra');
    function renderCalc(mode='basic'){
      let html='';
      if(mode==='basic'){
        html = `
          <div class="form__row">
            <label class="form__label" for="a">Number A</label>
            <input id="a" class="form__input" type="number" step="any" placeholder="e.g., 12.5" required />
          </div>
          <div class="form__row">
            <label class="form__label" for="op">Operation</label>
            <select id="op" class="form__select">
              <option value="+">Add (+)</option>
              <option value="-">Subtract (‚àí)</option>
              <option value="*">Multiply (√ó)</option>
              <option value="/">Divide (√∑)</option>
              <option value="%">Percent (A % of B)</option>
            </select>
          </div>
          <div class="form__row">
            <label class="form__label" for="b">Number B</label>
            <input id="b" class="form__input" type="number" step="any" placeholder="e.g., 3" required />
          </div>`;
      } else if(mode==='gst'){
        html = `
          <div class="form__row">
            <label class="form__label" for="base">Base Amount</label>
            <input id="base" class="form__input" type="number" step="0.01" placeholder="0.00"/>
          </div>
          <div class="form__row">
            <label class="form__label" for="rate">GST Rate (%)</label>
            <input id="rate" class="form__input" type="number" step="0.01" placeholder="18" />
          </div>`;
      } else {
        html = `
          <div class="form__row">
            <label class="form__label" for="price">Original Price</label>
            <input id="price" class="form__input" type="number" step="0.01" placeholder="1000.00"/>
          </div>
          <div class="form__row">
            <label class="form__label" for="off">Discount (%)</label>
            <input id="off" class="form__input" type="number" step="0.01" placeholder="10"/>
          </div>`;
      }
      calcFields.innerHTML = html;
      calcExtra.hidden = true;
      calcResult.textContent = '0';
    }
    renderCalc();

    document.querySelectorAll('input[name="mode"]').forEach(r=>{
      r.addEventListener('change', ()=> renderCalc(r.value));
    });

    calcFields.addEventListener('input', ()=>{
      const mode = document.querySelector('input[name="mode"]:checked').value;
      if(mode==='basic'){
        const A = Number(document.getElementById('a')?.value);
        const op = document.getElementById('op')?.value;
        const B = Number(document.getElementById('b')?.value);
        if(Number.isNaN(A) || Number.isNaN(B)) return calcResult.textContent='‚Äî';
        const val = op==='+'?A+B:op==='-'?A-B:op==='*'?A*B:op==='/'?(B===0?'‚àû':A/B):(A/100)*B;
        calcResult.textContent = (typeof val==='number') ? Number(val.toFixed(6)).toString() : val;
      } else if(mode==='gst'){
        const base = Number(document.getElementById('base')?.value);
        const rate = Number(document.getElementById('rate')?.value);
        if(Number.isNaN(base) || Number.isNaN(rate)) return calcResult.textContent='‚Äî';
        const tax = base * (rate/100);
        const total = base + tax;
        calcResult.textContent = total.toFixed(2);
        calcExtra.hidden = false;
        calcExtra.textContent = `Tax: ‚Çπ ${tax.toFixed(2)}`;
      } else {
        const price = Number(document.getElementById('price')?.value);
        const off = Number(document.getElementById('off')?.value);
        if(Number.isNaN(price) || Number.isNaN(off)) return calcResult.textContent='‚Äî';
        const saved = price * (off/100);
        const pay = price - saved;
        calcResult.textContent = pay.toFixed(2);
        calcExtra.hidden = false;
        calcExtra.textContent = `You save: ‚Çπ ${saved.toFixed(2)}`;
      }
    });

    /* -------------------- Marketplace -------------------- */
    const products = [
      {id:1, name:'Pro Chat Widget', price:19, category:'software', rating:4.7, img:'https://images.unsplash.com/photo-1545987796-200677ee1011?q=80&w=800&auto=format&fit=crop'},
      {id:2, name:'AI Image Credits (100)', price:12, category:'software', rating:4.5, img:'https://images.unsplash.com/photo-1531297484001-80022131f5a1?q=80&w=800&auto=format&fit=crop'},
      {id:3, name:'USB-C Hub (8-in-1)', price:39, category:'hardware', rating:4.4, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=800&auto=format&fit=crop'},
      {id:4, name:'Mechanical Keyboard', price:79, category:'hardware', rating:4.8, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=800&auto=format&fit=crop'},
      {id:5, name:'Frontend Masterclass', price:59, category:'courses', rating:4.9, img:'https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=800&auto=format&fit=crop'},
      {id:6, name:'Backend Bootcamp', price:89, category:'courses', rating:4.6, img:'https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=800&auto=format&fit=crop'},
    ];
    const marketGrid = document.getElementById('marketGrid');
    const marketMeta = document.getElementById('marketMeta');
    const search = document.getElementById('search');
    const category = document.getElementById('category');
    const sort = document.getElementById('sort');
    const cartCount = document.getElementById('cartCount');

    const CART_KEY = 'novahub_cart_v1';
    const loadCart = () => JSON.parse(localStorage.getItem(CART_KEY) || '[]');
    const saveCart = v => localStorage.setItem(CART_KEY, JSON.stringify(v));
    const setCartBadge = () => cartCount.textContent = loadCart().reduce((n,i)=>n+i.qty,0);

    function stars(n){
      const full = Math.round(n); // simple
      return '‚òÖ'.repeat(full) + '‚òÜ'.repeat(5-full);
    }
    function productCard(p){
      return `
        <article class="product" role="listitem" aria-label="${p.name}">
          <div class="product__img"><img src="${p.img}" alt="${p.name}" loading="lazy"></div>
          <div class="product__meta">
            <h3 style="margin:.2rem 0">${p.name}</h3>
            <span class="product__price">‚Çπ ${p.price}</span>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <span class="badge"><span class="stars" aria-hidden="true">${stars(p.rating)}</span> <span class="sr-only">Rating ${p.rating} of 5</span></span>
            <span class="badge">${p.category}</span>
          </div>
          <button class="btn btn--primary" data-add="${p.id}" aria-label="Add ${p.name} to cart">Add to cart</button>
        </article>
      `;
    }
    function currentList(){
      const q = search.value.trim().toLowerCase();
      const cat = category.value;
      let list = products.filter(p => (cat==='all'||p.category===cat) && p.name.toLowerCase().includes(q));
      if (sort.value==='price-asc') list.sort((a,b)=>a.price-b.price);
      else if (sort.value==='price-desc') list.sort((a,b)=>b.price-a.price);
      return list;
    }
    function renderList(){ const list=currentList(); marketGrid.innerHTML=list.map(productCard).join(''); marketMeta.textContent=`${list.length} item${list.length!==1?'s':''}`; }
    renderList(); setCartBadge();

    [search,category,sort].forEach(el=> el.addEventListener('input', renderList));
    marketGrid.addEventListener('click', (e)=>{
      const id = e.target?.dataset?.add; if(!id) return;
      const cart = loadCart();
      const idx = cart.findIndex(i=>i.id===Number(id));
      if(idx>-1) cart[idx].qty += 1; else cart.push({id:Number(id), qty:1});
      saveCart(cart); setCartBadge();
      e.target.textContent='Added ‚úì'; setTimeout(()=> e.target.textContent='Add to cart', 900);
    });

    /* -------------------- Chatbot -------------------- */
    const chatToggle = document.getElementById('chatToggle');
    const chatPanel = document.getElementById('chatPanel');
    const chatClose = document.getElementById('chatClose');
    const chatLog = document.getElementById('chatLog');
    const chatForm = document.getElementById('chatForm');
    const chatInput = document.getElementById('chatInput');
    const chips = document.getElementById('chips');

    function openChat(){ chatPanel.hidden=false; chatToggle.setAttribute('aria-expanded','true'); chatInput.focus(); }
    function closeChat(){ chatPanel.hidden=true; chatToggle.setAttribute('aria-expanded','false'); }
    chatToggle.addEventListener('click', ()=> chatPanel.hidden ? openChat() : closeChat());
    chatClose.addEventListener('click', closeChat);
    chips.addEventListener('click', (e)=>{ if(e.target.classList.contains('chip')) { chatInput.value = e.target.textContent; chatInput.focus(); } });

    function bubble(text, who='ai'){
      const b=document.createElement('div'); b.className='bubble '+(who==='me'?'bubble--me':'bubble--ai'); b.textContent=text; chatLog.appendChild(b); chatLog.scrollTop=chatLog.scrollHeight;
    }
    function parseInlineCalc(s){
      const m=s.match(/(-?\d+(?:\.\d+)?)\s*([+\-*/])\s*(-?\d+(?:\.\d+)?)/); if(!m) return null;
      const A=parseFloat(m[1]), op=m[2], B=parseFloat(m[3]); if(op==='/'&&B===0) return '‚àû';
      const v = op==='+'?A+B:op==='-'?A-B:op==='*'?A*B:A/B; return Number(v.toFixed(6)).toString();
    }
    function reply(msg){
      const t=msg.trim().toLowerCase(); if(!t) return "Say 'help' to see options.";
      if(t==='help') return "I can: (1) show time, (2) compute e.g., 'calc 12+7', (3) show 'deals', (4) 'cart total', (5) search: 'find keyboard'.";
      if(t==='time') return "Local time: "+new Date().toLocaleString();
      if(t==='cart total') return "Items in cart: "+loadCart().reduce((n,i)=>n+i.qty,0);
      if(t.includes('deals')) return "Today‚Äôs picks: Pro Chat Widget ‚Çπ 19, USB-C Hub ‚Çπ 39, Mechanical Keyboard ‚Çπ 79.";
      if(t.startsWith('find ')){
        const q=t.replace('find ','').trim();
        const hits=products.filter(p=>p.name.toLowerCase().includes(q));
        return hits.length?`Found ${hits.length}: `+hits.map(h=>h.name).join(', '):'No matches.';
      }
      if(t.startsWith('calc ')){ const r=parseInlineCalc(t.slice(5)); return r?('Result: '+r):"Try 'calc 12+7' or 'calc 9/3'."; }
      const r2=parseInlineCalc(t); if(r2) return 'Result: '+r2;
      return "Got it! (Demo bot) ‚Äî hook me to your API for real answers.";
    }
    chatForm.addEventListener('submit',(e)=>{e.preventDefault(); const msg=chatInput.value; if(!msg.trim()) return; bubble(msg,'me'); chatInput.value=''; setTimeout(()=>bubble(reply(msg),'ai'),140); });

    /* -------------------- Small UX helpers -------------------- */
    document.addEventListener('keydown',(e)=>{ if(e.key==='/' && document.activeElement?.tagName!=='INPUT' && document.activeElement?.tagName!=='TEXTAREA'){ e.preventDefault(); openChat(); }});
  </script>
</body>
</html>
